# Specification: 로그인 없는 EPUB 브라우징 및 TTS 지원 고급 리더 구현

## 1. Overview
로그인 없이 접근 가능한 공개 폴더 브라우징 기능을 제공하고, 해당 폴더 내의 EPUB 파일을 웹/모바일에서 즉시 감상할 수 있는 뷰어를 구현합니다. 특히, 서버 측 오픈소스 TTS 엔진을 연동하여 고품질 한글 음성 낭독 기능을 제공하며, 낭독 시 현재 읽고 있는 문장을 시각적으로 강조(하이라이팅)하고 페이지를 자동으로 넘겨주는 몰입형 독서 경험을 목표로 합니다.

## 2. Functional Requirements

### 2.1 Public Library Browsing (비로그인 브라우징)
- **FR-01:** 사용자는 로그인 없이 `/public/library` 경로에 접근하여 사전 설정된 공개 디렉토리의 파일 목록을 볼 수 있어야 한다.
- **FR-02:** 파일 목록은 썸네일(표지)이 포함된 카드 형태 또는 리스트 형태로 제공되어야 하며, 모바일 환경에서도 보기 편해야 한다.
- **FR-03:** 지원하지 않는 파일 형식은 목록에서 제외하거나 비활성화 처리해야 한다.

### 2.2 EPUB Reader (EPUB 뷰어)
- **FR-04:** 브라우저 내에서 별도의 앱 설치 없이 EPUB 파일을 열고 내용을 표시해야 한다 (e.g., ePub.js 활용).
- **FR-05:** 폰트 크기 조절, 다크 모드/라이트 모드 전환, 목차(TOC) 탐색 기능을 제공해야 한다.
- **FR-06:** 읽던 위치(페이지)를 로컬 스토리지 또는 서버(비로그인 세션)에 저장하여, 재접속 시 이어볼 수 있어야 한다.

### 2.3 TTS Integration (음성 합성 연동)
- **FR-07:** 서버에 설치된 오픈소스 TTS 엔진(Piper, Sherpa-ONNX 등)을 통해 EPUB 텍스트를 음성 스트림으로 변환해야 한다.
- **FR-08:** 사용자는 재생/일시정지, 이전/다음 문장 이동, 배속 조절(0.5x ~ 2.0x) 기능을 제어할 수 있어야 한다.
- **FR-09:** TTS 재생 중, 현재 읽고 있는 문장이나 단락을 UI 상에서 하이라이트(음영) 처리해야 한다.
- **FR-10:** 하이라이트된 문장이 현재 뷰포트를 벗어날 경우, 자동으로 해당 페이지로 스크롤 또는 페이지 넘김이 이루어져야 한다.

## 3. Non-Functional Requirements
- **NFR-01 (Performance):** TTS 음성 생성 지연 시간은 문장 단위 요청 시 2초 이내여야 한다.
- **NFR-02 (Mobile-First):** 모든 UI는 모바일 터치 인터페이스에 최적화되어야 한다.
- **NFR-03 (Accessibility):** 모든 컨트롤은 키보드 및 스크린 리더로 조작 가능해야 한다.

## 4. Acceptance Criteria
- [ ] 로그인 없이 공개 라이브러리 페이지에 접속하여 EPUB 파일을 선택할 수 있는가?
- [ ] 선택한 EPUB 파일이 뷰어에서 정상적으로 렌더링되는가?
- [ ] TTS 재생 버튼을 눌렀을 때, 서버에서 생성된 한글 음성이 끊김 없이 재생되는가?
- [ ] 음성 재생에 맞춰 텍스트가 정확히 하이라이팅되고 페이지가 자동으로 넘어가는가?
